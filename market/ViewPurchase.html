<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Blue0x Decentralized Marketplace">
  <link rel="shortcut icon" href="img/favicon.ico">
  <title>Blue0x | MARKET</title>
  <link href="css/bootstrap.min.css" rel="stylesheet">
  <link href="css/bootstrap-reset.css" rel="stylesheet">
  <link href="assets/font-awesome/css/font-awesome.min.css" rel="stylesheet" />
  <link href="css/style.min.css" rel="stylesheet">
  <link href="css/style-responsive.css" rel="stylesheet" />
  <link href="css/spinner.css" rel="stylesheet">
  <script>
  function itemReceived() {
    // Put in secret phrase field  
    var secretPhrase = parent.passphrase;
    var listingid = (getQueryVariable("itemid"));
    // Disable the button while NxtPass does its work
    document.getElementById("buttonSection").innerHTML = "<a class=\"btn btn-default\" id=\"receivedButton\" type=\"button\"><span data-i18n=\"button_item_received\"><i class=\"fa fa-refresh fa-spin\"></i> &nbsp;Processing...</span></a><a class=\"btn btn-danger\" id=\"notReceivedButton\" type=\"button\"><span data-i18n=\"button_item_not_received\">Item Not Received</span></a>";

    $.post(Constants.apiUrl, {
        requestType: 'item_received',
        listing_id: listingid,
        messageToSeller: $('#messageToSeller').val(),
        usersSecretPhrase: secretPhrase
      },
      function(result) {
        var item_received_status = result.query_status;
        if (item_received_status == 'good') {
          document.getElementById("successMessage").innerHTML = "Success: You have marked this item as received and completed the escrow process. The seller will be paid.";
        } else {
          // Display failure message  
          document.getElementById("successMessage").innerHTML = " Result: FAILURE to mark this item as received and complete the escrow process. The seller will not be paid.";
        }
      }, "json"); // Specifies JSON as the expected result
  };
  </script>

  <script>
  function itemNotReceived() {
    /* !Needs work */
    // Put in secret phrase field  
    var secretPhrase = parent.passphrase;
    var listingid = (getQueryVariable("itemid"));

    // Disable the button while NxtPass does its work
    document.getElementById("buttonSection").innerHTML = "<a class=\"btn btn-default\" id=\"receivedButton\" type=\"button\"><span data-i18n=\"button_item_received\">Item Received</span></a><a class=\"btn btn-danger\" id=\"notReceivedButton\" type=\"button\"><span data-i18n=\"button_item_not_received\"><i class=\"fa fa-refresh fa-spin\"></i> &nbsp;Processing...</span></a>";

    $.post(Constants.apiUrl, {
        requestType: 'item_not_received',
        listing_id: listingid,
        messageToSeller: $('#messageToSeller').val(),
        usersSecretPhrase: secretPhrase
      },
      function(result) {

        var item_not_received_status = result.query_status;
        if (item_not_received_status == 'good') {

          document.getElementById("successMessage").innerHTML = "Success: You have marked this item as not received. Your escrow provider will be informed.";
        } else {
          // Display failure message  
          document.getElementById("successMessage").innerHTML = " Result: FAILURE to mark this item as not received.";
        }
      }, "json"); 
  };
  </script>
</head>
<body class="full-width" onload="setAccountNumber(); setLanguage();">
  <section id="container">
    <script type="text/javascript" src="js/menu.js"></script>
    <section id="main-content">
      <section class="wrapper">
        <div class="row">
          <div class="col-lg-12">
            <section class="panel">
              <header class="panel-heading">
              </header>
              <div class="panel-body">
                <div id="successMessage">
                  <aside class="profile-nav alt">
                    <section class="panel">
                      <div class="user-heading alt">
                        <span id="top_image"><a href="#"><img alt="" src="img/Box-icon.png"></a></span>
                        <h1 id="title">No Item Title</h1>
                        <p><span data-i18n="item_id">Item ID</span>: <span id="itemID"></span></p>
                        <p><span data-i18n="seller_id">Seller ID</span>: <span id="seller_id"></span></p>
                        <p><span data-i18n="status">Status</span>: <span id="status"></span></p>
                        <br />
                        <hr>
                        <p><i class="fa fa-tasks"></i> <span data-i18n="category">Category</span>: <span id="category"></span></a>
                        </p>
                        <p><i class="fa fa-tags"></i> <span data-i18n="tags">Tags</span>: <span id="tags"></span></a>
                        </p>
                        <p><i class="fa fa-clock-o"></i> <span data-i18n="expiration">Expired</span>: <span id="expiration"></span></a>
                        </p>
                        <p><i class="fa fa-clock-o"></i> <span data-i18n="sold_date"></span>: <span id="sold"></span></a>
                        </p>
                        <p><i class="fa fa-signal"></i> <span data-i18n="quantity_purchased">Quantity Purchased</span>: <span id="quantity_purchased"></span></p>
                        <p><i class="fa fa-money"></i> <span data-i18n="total_price">Price</span>: <span id="price"></span></a>
                        </p>
                        <hr>
                        <p><span data-i18n="description">Description</span>
                          <br /><span id="description"></span></p>
                      </div>
                    </section>
                  </aside>
                  <div id="extra_images_section"></div>
                </div>
              </div>
            </section>
          </div>
        </div>
      </section>      
    </section>
  </section>
  <script src="js/jquery.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script src="js/jquery.dcjqaccordion.2.7.min.js"></script>
  <script src="js/bootstrap-hover-dropdown.min.js"></script>
  <script src="js/constants.js"></script>
  <script src="js/freemarket_scripts.js"></script>
  <script src="js/common-scripts.js"></script>
  <script src="js/i18next.min.js"></script>
  <script src="js/freemarket_localization_scripts.js"></script>
  <script src="js/pending_sales_notice.js"></script>
  <script src="js/validator.min.js"></script>
</body>
</html>